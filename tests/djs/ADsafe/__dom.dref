
(*weak (~lNodes: {Arr(Ref(~lNode))|(and (packed v) (>= (len v) 0))} > lArrPro)*)
weak (~lNodes: { Arr(Ref(~lNode)) | (packed v)} > lArrPro)

weak (~lEvent: {
  "type":Str,
  target:Ref(~lNode),    (* could also be Ref(~lEventTarget) *)
  cancelBubble: Bool,
  stopPropagation: () -> Top,
  bubble: () -> Top,
  srcElement: Ref(~lNode),
  altKey:Bool, 
  ctrlKey:Bool,
  shiftKey:Bool
} > lObjPro)

weak (~lEventTarget: { } > lObjPro)

weak (~lSelector: {
  op:Str,
  name:Str,
  value:Str
} > lObjPro)

weak (~lQuery: { Arr(Ref(~lSelector)) | (packed v) } > lArrPro)

weak (~lBunchs: Arr(Ref(~lBunch)) > lArrPro)

weak (~lBunch: {
  "___nodes___": Ref(~lNodes),
  "___star___": Bool,
  fire: (Ref(~lEvent)) -> Top
  (*getParents: () -> Ref(~lBunchs) *) (* Need to fix arrow subtyping first *)
} > lBunchProto)

weak (~lCCSStyle: {
    visibility: Str
} > lObjPro)

weak (~lSelection: { createRange: () -> Ref(~lDocument) }  > lObjPro) 

weak (~lNList: {Arr(Ref(~lNode))|(and (packed v) (>= (len v) 1))} > lArrPro)

weak (~lNode: {
    getComputedStyle:[;;H_] (this:Ref(~lNode), node:Ref(~lNode),str:Str) / H_ -> Ref(~lCCSStyle) / (H_), currentStyle:Ref(~lCCSStyle),
    firstChild:Ref(~lNode), 
    nextSibling:Ref(~lNode), 
    childNodes:Ref(~lNList),
    change:Ref(~lEvent), 
    "___ on ___":Ref(~lEvent),
    "___adsafe root___": Bool,
    tagName:Str, 
    className:Str, 
    name:Str,
    nodeName:Str,
    nodeValue:Str,
    disabled:Bool,
    checked:Bool,
    fire:(NotUndef) -> Top,
    getElementsByTagName:[;L;] (this:Ref(~lNode), name:Str) / () -> Ref(L) / (L: _underscore_3:{Arr(Ref(~lNode))|(packed v)})} > lObjPro)

weak (~lDocument: {
    defaultView:Ref(~lNode),
    selection: Ref(~lSelection),
    getElementById:[;;H_] (this:Top, s:Str) / H_ -> Ref(~lNode) / (H_)} > lObjPro)


